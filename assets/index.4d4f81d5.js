import{r as d,j as e,a as R,F as m,b as l,d as E,c as I,e as k,f as S,g as M,h as $,i as F,k as O,l as U,m as W,R as q,n as T}from"./vendor.ee96b789.js";const Z=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}};Z();var o={API:{host:"https://expenses-kawlik.herokuapp.com",auth:{facebook:"https://expenses-kawlik.herokuapp.com/auth/facebook"},link:{expense:{get:{findAllBy_listID:"/expense/list/"},post:{addNewBy_listID:"/expense/add/"},put:{argueBy_expenseID:"/expense/argue/"}},list:{get:{findAllBy_userID:"/list/all/"},post:{addNewBy_userID:"/list/add/"},put:{lockBy_listID:"/list/locl/"}},user:{get:{findOneBy_auth:"/user/auth/",findAllBy_name:"/user/name/",findOneBy_userID:"/user/id/"},put:{addNewAsFriendBy_userID:"/user/add/",romoveUserAsFriend_userID:"/user/remove/"}}}},views:{list:["saved","active","profile"],name:{saved:"saved",active:"active",profile:"profile"}}};const b=d.exports.createContext(null),Y=({children:t})=>{const[n,r]=d.exports.useState(null),[a,s]=d.exports.useState(null),[i,c]=d.exports.useState(!1),x={user:n,setUser:r,list:a,setList:s,load:i,setLoad:c};return d.exports.useEffect(()=>()=>{},[]),e(b.Provider,{value:x,children:t})},z=(t,n="")=>o.API.host+t+n,A=async(t,n)=>{try{const r=await R.get(z(t,n)),a=r==null?void 0:r.data;if(a==null?void 0:a.success)return a.response;throw new Error("Request could not be processed!")}catch(r){return console.error(r),null}},D=async(t,n,r)=>{try{const a=await R.post(z(t,n),r),s=a==null?void 0:a.data;if(s==null?void 0:s.success)return s.response;throw new Error("Request could not be processed!")}catch(a){return console.error(a),null}},L=async(t,n,r)=>{try{const a=await R.put(z(t,n),r),s=a==null?void 0:a.data;if(s==null?void 0:s.success)return s.response;throw new Error("Request could not be processed!")}catch(a){return console.error(a),null}},B=async t=>{try{const n=[];for(const r of t.friends){const a=await A(o.API.link.user.get.findOneBy_userID,r);n.push(a)}return n}catch(n){return console.error(n),null}},H=()=>{const{setUser:t,setList:n}=d.exports.useContext(b),r=async a=>{try{const s=await A(o.API.link.user.get.findOneBy_auth,a);if(a===(s==null?void 0:s.auth)){s.friends=await B(s);const i=await A(o.API.link.list.get.findAllBy_userID,s._id);for(const c of i)c.userA=await A(o.API.link.user.get.findOneBy_userID,c.userA),c.userB=await A(o.API.link.user.get.findOneBy_userID,c.userB),c.expenses=await A(o.API.link.expense.get.findAllBy_listID,c._id);t(s),n(i)}}catch(s){return console.error(s)}};return d.exports.useEffect(()=>{const a=new URL(window.location.href),s=new URLSearchParams(a.search);s.has("auth")&&r(s.get("auth")),window.history.replaceState(null,document.title,window.location.pathname)},[]),e(m,{children:e("div",{className:"modal modal-signin position-static d-block bg-light py-5",children:e("div",{className:"modal-dialog",children:e("div",{className:"modal-content shadow",style:{borderRadius:"15px"},children:l("div",{className:"modal-body p-4",children:[e("h2",{className:"fw-bold p-2 mb-4",children:"Logowanie"}),l("a",{href:o.API.auth.facebook,className:"w-100 btn btn-lg btn-outline-primary mb-2",type:"button",style:{borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(E,{style:{fontSize:"32px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zaloguj z Facebook"})]}),e("hr",{className:"mb-3"}),e("small",{className:"text-muted",children:"Do zalogowania si\u0119 konieczne jest skorzystanie z wybranego serwisu spo\u0142eczno\u015Bciowego. Korzystanie z takiej metody logowania zwi\u0119ksza bezpiecze\u0144stwo i zmniejsza ilo\u015B\u0107 koniecznych do zapami\u0119tania hase\u0142."})]})})})})})},P=({user:t,action:n})=>e(m,{children:l("li",{className:"list-group-item shadow-sm p-1",style:{borderRadius:"10px"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-success py-1 px-3",onClick:r=>n(r,t._id),style:{borderRadius:"10px",float:"right"},children:e(I,{style:{verticalAlign:"middle"}})})]})}),V=()=>{const{user:t,setList:n}=d.exports.useContext(b),r=async(a,s)=>{a.preventDefault();try{const i=await D(o.API.link.list.post.addNewBy_userID,s,{auth:t.auth});i.userA=await getData(o.API.link.user.get.findOneBy_userID,i.userA),i.userB=await getData(o.API.link.user.get.findOneBy_userID,i.userB),i.expenses=await getData(o.API.link.expense.get.findAllBy_listID,i._id),n(c=>[...c,i])}catch(i){return console.error(i)}};return e(m,{children:l("section",{className:"p-2 border mt-5 shadow",style:{borderRadius:"10px"},children:[e("h2",{className:"fw-bold fs-5 mb-3",children:"Dodaj nowe rozliczenie"}),e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:t.friends.length?t.friends.map(a=>e(P,{user:a,action:s=>r(s,a._id)},a._id)):e("h3",{className:"fw-light fs-4 my-3 mx-2 text-center",children:"Dodaj znajomych, by m\xF3c towrzy\u0107 rozliczenia!"})})]})})},X=({list:t})=>{const{user:n,setList:r}=d.exports.useContext(b),[a,s]=d.exports.useState(""),[i,c]=d.exports.useState(""),[x,y]=d.exports.useState(""),h=u=>{s(u.target.value)},g=u=>{c(Math.min(u.target.value,1e4)==0?"":Math.min(u.target.value,1e4))},p=u=>{y(u.target.value)},N=async u=>{u.preventDefault();const v={auth:n.auth,data:{_id_list:t._id,user:x,name:a,value:i}};try{const w=await D(o.API.link.expense.post.addNewBy_listID,t._id,v);t.expenses.push(w),r(_=>[..._.filter(f=>f._id!==t._id),t]),y(""),c(""),s("")}catch(w){return console.error(w)}};return e(m,{children:l("div",{className:"row my-1 py-1",children:[e("div",{className:"col-12 mb-3",children:l("select",{value:x,onChange:p,className:"form-select",style:{height:"42px",borderRadius:"10px"},children:[e("option",{value:t.userA._id,children:t.userA.body.name}),e("option",{value:t.userB._id,children:t.userB.body.name})]})}),e("div",{className:"col-12 mb-3",children:e("input",{value:a,onChange:h,type:"text",className:"form-control",placeholder:"Wydatek",style:{height:"42px",borderRadius:"10px"}})}),l("div",{className:"col-12 mb-3 input-group",children:[e("input",{value:i,onChange:g,min:1,max:1e4,step:1,type:"number",className:"form-control",placeholder:"Cena",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:".00"})]}),e("div",{className:"col-12",children:l("button",{disabled:a===""||i===""||x==="",onClick:N,type:"button",className:"btn btn-outline-success w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(I,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Dodaj"})]})})]})})},j=({list:t})=>{const n=t.expenses.filter(i=>i.user===t.userA._id).map(i=>i.value),r=t.expenses.filter(i=>i.user===t.userB._id).map(i=>i.value),a=n.length?n.reduce((i,c)=>i+c):0,s=r.length?r.reduce((i,c)=>i+c):0;return l(m,{children:[e("h4",{className:"lead",children:t.date.split("T")[0]}),l("div",{className:"py-1 w-100",children:[l("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(k,{})}),e("span",{style:{verticalAlign:"middle"},children:a})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userA.body.picture,alt:t.userA.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userA.body.name})]}),l("div",{className:"py-1 w-100",children:[l("span",{className:"badge bg-info",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(k,{})}),e("span",{style:{verticalAlign:"middle"},children:s})]}),e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.userB.body.picture,alt:t.userB.body.name,style:{width:"32px",height:" 32px",borderRadius:"32px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"20px",fontWeight:"300"},children:t.userB.body.name})]})]})},C=({list:t})=>e(m,{children:t.expenses.map(n=>l("figure",{className:"m-1 p-1 shadow-sm rounded",children:[l("blockquote",{className:"blockquote",children:[l("span",{className:"badge bg-secondary",style:{verticalAlign:"middle",marginRight:"10px",minWidth:"84px",height:" 32px",textAlign:"left"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"5px"},children:e(k,{})}),e("span",{style:{verticalAlign:"middle"},children:n.value})]}),e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:n.name})]}),e("figcaption",{className:"blockquote-footer",children:t.userA._id===n.user?t.userA.body.name:t.userB.body.name})]},n._id))}),K=({list:t})=>e(m,{children:l("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(j,{list:t}),l("details",{className:"py-1 w-100 my-2",children:[l("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),l("div",{className:"py-1 w-100 my-4",children:[e("h5",{className:"lead",children:"Dodaj nowy wydatek"}),e(X,{list:t})]}),l("div",{className:"py-1 w-100",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(C,{list:t})]})]}),l("button",{className:"w-100 btn btn-outline-danger mt-2",type:"button",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(M,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Zako\u0144cz"})]})]})}),G=()=>{const{list:t}=d.exports.useContext(b),n=t.filter(r=>!r.status.finished);return l(m,{children:[n.length?n.map(r=>e(K,{list:r},r._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 aktywne rozliczenia z innymi u\u017Cytkownikami."}),e(V,{})]})},J=({user:t,action:n})=>l(m,{children:[l("li",{className:"w-100 mb-2 shadow-sm rounded p-1",style:{listStyle:"none"},children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"42px",height:"42px",borderRadius:"42px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"28px",fontWeight:"300"},children:t.body.name}),e("button",{type:"button",className:"btn btn-outline-danger py-1 px-3",onClick:r=>n(r,t._id),style:{borderRadius:"10px",float:"right"},children:e($,{style:{verticalAlign:"middle"}})})]}),e("hr",{className:"mb-3",style:{height:"0.5px"}})]}),Q=()=>{const{user:t,setUser:n}=d.exports.useContext(b),[r,a]=d.exports.useState(""),[s,i]=d.exports.useState([]),c=async h=>{const g=h.target.value;a(g);try{if(g.length>=3){const p=await A(o.API.link.user.get.findAllBy_name+g);i(p.filter(N=>N._id!==t._id||!t.friend.includes(N)))}else i([])}catch(p){return console.error(p)}},x=async(h,g)=>{h.preventDefault();try{const p=await L(o.API.link.user.put.addNewAsFriendBy_userID,g,{auth:t.auth});t.friends=await B(p),a(""),i([])}catch(p){return console.error(p)}},y=async(h,g)=>{h.preventDefault();try{const p=await L(o.API.link.user.put.romoveUserAsFriend_userID,g,{auth:t.auth});t.friends=await B(p),a(""),i([])}catch(p){return console.error(p)}};return l(m,{children:[l("section",{className:"mb-3 w-100 p-2",children:[e("span",{style:{verticalAlign:"middle",marginRight:"10px"},children:e("img",{src:t.body.picture,alt:t.body.name,style:{width:"50px",height:" 50px",borderRadius:"50px"}})}),e("span",{style:{verticalAlign:"middle",fontSize:"32px",fontWeight:"300"},children:t.body.name}),e("hr",{}),l("div",{className:"input-group",children:[e("input",{value:r,onChange:c,type:"text",className:"form-control",placeholder:"Wyszukaj znajomego",style:{height:"42px",borderTopLeftRadius:"10px",borderBottomLeftRadius:"10px"}}),e("span",{className:"input-group-text",style:{height:"42px",borderTopRightRadius:"10px",borderBottomRightRadius:"10px"},children:e(F,{})})]}),s.length?e("div",{className:"my-2",children:e("ul",{className:"list-group border p-1 mb-2",style:{overflowY:"scroll",maxHeight:"40vh",borderRadius:"10px"},children:s.map(h=>e(P,{user:h,action:x},h._id))})}):null]}),l("section",{className:"w-100 p-2",children:[e("h2",{className:"display-6",children:"Znajomi"}),t.friends.map(h=>e(J,{user:h,action:y},h._id))]})]})},ee=({list:t})=>e(m,{children:l("div",{className:"mb-3 border p-2 shadow",style:{borderRadius:"10px"},children:[e(j,{list:t}),l("details",{className:"py-1 w-100 mt-2",children:[l("summary",{className:"btn btn-outline-secondary w-100",style:{height:"42px",borderRadius:"10px"},children:[e("span",{style:{marginRight:"10px",verticalAlign:"middle"},children:e(S,{style:{fontSize:"24px"}})}),e("span",{style:{verticalAlign:"middle"},children:"Wi\u0119cej"})]}),l("div",{className:"py-1 w-100 mt-4",children:[e("h5",{className:"lead",children:"Zapisane wydatki"}),e(C,{list:t})]})]})]})}),te=()=>{const{list:t}=d.exports.useContext(b),n=t.filter(r=>r.status.finished);return e(m,{children:n.length?n.map(r=>e(ee,{list:r},r._id)):e("h3",{className:"fw-light fs-4 mt-5 mx-2 text-center",children:"Tu pojawiaj\u0105 si\u0119 zako\u0144czone przez Ciebie rozliczenia."})})},se=({view:t,setView:n,setSwipe:r})=>e(m,{children:l("nav",{className:"nav navbar-dark bg-light row p-2 w-100",id:"view-selector",children:[e("li",{className:`col-3 row mx-auto  ${t===o.views.name.saved&&"active"}`,children:l("button",{className:"mx-auto btn pb-3",onClick:()=>{n(o.views.name.saved),r(null)},children:[e(O,{style:{fontSize:"28px"}}),e("small",{children:"Zapisane"})]})}),e("li",{className:`col-3 row mx-auto ${t===o.views.name.active&&"active"}`,children:l("button",{className:"mx-auto btn pb-3",onClick:()=>{n(o.views.name.active),r(null)},children:[e(U,{style:{fontSize:"28px"}}),e("small",{children:"Aktywne"})]})}),e("li",{className:`col-3 row mx-auto ${t===o.views.name.profile&&"active"}`,children:l("button",{className:"mx-auto btn pb-3",onClick:()=>{n(o.views.name.profile),r(null)},children:[e(W,{style:{fontSize:"28px"}}),e("small",{children:"Profil"})]})})]})}),ne=()=>{const[t,n]=d.exports.useState(o.views.name.profile),[r,a]=d.exports.useState(null),s={x:null,y:null},i=y=>{s.x=y.touches[0].clientX,s.y=y.touches[0].clientY},c=y=>{if(!s.x||!s.y)return;const h=Math.min(window.innerWidth/3,300),g=.33,p=y.touches[0].clientX,N=y.touches[0].clientY,u=s.x-p,v=s.y-N;if(Math.abs(u)>Math.abs(v)){const w=u<=0?1:-1,_=Math.max(1-(Math.abs(u)-Math.abs(v))/h,0),f=w*g*(Math.abs(u)-Math.abs(v));document.querySelector("#view-content").style.transition=null,document.querySelector("#view-content").style.opacity=_,document.querySelector("#view-content").style.transform=`translateX( ${f}px )`}if(Math.abs(u)>Math.abs(v)&&Math.abs(u)-Math.abs(v)>h){const w=0,_=o.views.list.length-1,f=o.views.list.indexOf(t);u<0&&f-1>=w&&(n(o.views.list[f-1]),a("left")),u>0&&f+1<=_&&(n(o.views.list[f+1]),a("right"))}},x=y=>{document.querySelector("#view-content").style.opacity=1,document.querySelector("#view-content").style.transition="all ease-in-out 0.3s",document.querySelector("#view-content").style.transform=null};return d.exports.useEffect(()=>(document.addEventListener("touchstart",i),document.addEventListener("touchmove",c),document.addEventListener("touchend",x),()=>{document.removeEventListener("touchstart",i),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",x)}),[t]),e(m,{children:l("main",{id:"view-container",children:[l("section",{id:"view-content",className:`p-2 w-100 ${r}`,children:[t===o.views.name.saved&&e(te,{}),t===o.views.name.active&&e(G,{}),t===o.views.name.profile&&e(Q,{})]},t),e(se,{view:t,setView:n,setSwipe:a})]})})},ie=()=>{const{user:t}=d.exports.useContext(b);return e(m,{children:t?e(ne,{}):e(H,{})})};const ae=()=>e(Y,{children:e(ie,{})});q.render(e(T.StrictMode,{children:e(ae,{})}),document.getElementById("root"));
